# Network Layer
Transport Layer가 process간의 통신을 지원했다면, Network Layer는 호스트간의 데이터 교환을 지원한다. 이때 데이터를 데이터그램 또는 패킷이라고 부른다.

# Network Layer가 하는 일
## Forwarding
패킷을 목적지로 전송하는 것을 의미

## Routing
1. 패킷을 어떤 경로로 보낼지 결정하는 것을 의미
2. Forwarding Table을 라우팅 알고리즘을 통해 만들고 해당 Table에는 각 목적지에 따라 보내는 경로가 적혀있다.
3. 이때 Forwarding Table은 일대일대응 관계가 아니라 범위를 지정해서 특정 범위에 해당하는 주소는 어떤 경로로 보낼지 결정된다.(용량 극복)
4. Forwarding Table은 주변 라우터들과의 정보교환을 통해 만들어진다.
5. 매칭할때는 Longest Prefix Matching으로 어떤 경로로 보낼지 결정한다.

# IP Protocol
Network Layer의 대표적인 프로토콜. 사실상 IP 프로토콜 하나만 쓴다해도 과언이 아니다.

## Datagram Header 구조

### 헤더 사이즈
TCP/IP 프로토콜이라면 TCP에서 20바이트, IP에서 20바이트 총 40바이트다.

### Time to Live
1. 네트워크 상에서 사이클을 형성하며 무한히 떠도는 패킷을 우려해 만든 헤더 정보
2. 이 패킷이 얼마나 많은 라우터를 거칠 수 있는지를 의미한다. 라우터를 거칠때마다 1만큼 감소한다.
3. 0이 되면 라우터에서 드랍한다.

### Upper Layer
1. Network Layer에서 Transport Layer로 디캡슐화하고 세그먼트를 올려야하는데 TCP인지 UDP인지 알아야 하기 때문에 존재한다.

### 출발/목적지 IP 주소

# IPv4
호스트마다 유일한 32bit 주소를 부여한다.

## 단순 무작위로 부여할까?
1. 무작위로 부여하게 되면 Forwarding table 용량이 커지게된다. 
2. 따라서 계층화하여 체계적으로 부여하는데 이때 앞단의 24bit를 네트워크주소, 나머지 8bit를 host 주소로 사용한다.
3. subnet mask를 통해 네트워크 주소를 판별할 수 있다.
4. 위와 같은 방법이면 새로운 주소 추가가 용이하다.

# CIDR
클래스 없는 도메인 간의 라우팅 기법으로 네트워크 클래스를 대체하였다.

# Subnet
라우터를 거치지 않고 갈 수 있는 host의 집합

# IP주소
1. 사실 ip주소는 특정 호스트의 주소라기보단 인터페이스의 주소라고 보는게 맞다.
2. 라우터의 경우 특성상 인터페이스가 많을 수 밖에 없는데 각 인터페이스마다 IP주소는 다르다.


