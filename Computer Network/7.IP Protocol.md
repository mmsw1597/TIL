# IP Fragmentation
1. 링크마다 최대 패킷 크기 제한이 존재한다 (MTU)
2. MTU보다 보내려고 하는 패킷이 더 크다면 패킷을 분해해야 한다.
3. 각각의 패킷은 서로 독립적으로 목적지를 향해 이동한다. (서로 다른 경로로 이동할 수 도 있다.)
4. 목적지에서는 분해된 패킷이 원본 패킷으로 조립되어야 한다.
5. 주의할 점은 IP 헤더는 제거되고 남은 데이터 부분을 분해하며 분해된 패킷마다 각각 헤더가 다시 붙는다.

## Fragmentation을 위한 헤더 요소
### 16 bit ID
1. 하나의 패킷이 분리 될 경우 분리된 패킷들은 하나의 공통된 16bit ID를 갖게 된다.
2. 해당 ID는 무작위이다.

### Frag flag
1. flag가 1이라면 자신의 뒤에 이어질 패킷이 더 있다는 뜻이다.
2. flag가 0이라면 자신이 마지막 패킷이라는 뜻이다.
3. 원본 패킷은 flag가 0이고 분해될 경우 맨 마지막 순서의 패킷은 flag가 0이고 이외에는 전부 flag가 1이다.

### Offset
1. 첫 바이트 번호 / 8 을 의미. 즉, 첫번째 분해된 패킷은 0이다.
2. 8로 나누는 이유는 8로 나눌시 비트가 왼쪽으로 3번 이동되고 이는 비트 수를 절약하기 위함.

## 만약 분해된 것중 일부가 손실된다면?
1. Transport Layer가 TCP라면 송신측에서 재전송을 할 것이며 UDP면 드랍할 것이다.
2. 라우터는 재전송 기능이 없다. 송신측에서 다시 원본을 재전송해야 한다.

# ICMP
1. 라우터와 host간에 컨트롤 메시지 전달에 쓰이는 프로토콜.
2. 사용자로 인해 생성된 데이터는 담고 있지 않다.
3. 네트워크 내부에서 여러가지 상황을 리포트하는 용도다.

# IPv6
IPv4와 달리 128bit 주소공간을 사용하는 프로토콜

## Tunneling
1. 만약 IPv4에서 IPv6로 전환을 한다면 과도기 시점에서는 IPv4와 IPv6를 사용하는 라우터가 공존할 것이다.
2. IPv4를 쓰는 라우터는 IPv6 패킷을 이해하지 못한다.
3. 따라서 IPv6 라우터는 다음 라우터가 IPv4라면 IPv6패킷을 통째로 데이터 부분에 담고 IPv4헤더를 달아서 전송해야 원할한 통신이 가능하다.

# Routing Algorithm

## Link State
1. 다익스트라 알고리즘을 사용한다.
2. 모든 라우터들은 현재 네트워크 상황(링크 연결 상황, 링크 가중치)를 알고 있다는 가정하에 쓰이는 알고리즘이다.
3. 따라서 사전에 브로드캐스트 메시지를 날려서 서로의 정보를 알 수 있게 하는 절차가 필요하다. 
